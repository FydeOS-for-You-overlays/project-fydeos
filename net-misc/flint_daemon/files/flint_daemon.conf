# Copyright (c) 2017 The Flint OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
description     "Job to trigger flint services"
author          "yang@flintos.io"

start on started system-services
stop on stopping system-services
respawn

env NODE_ENV=production

script
  # Reads in the DEBUG variable
  [ -f /mnt/stateful_partition/etc/.flintdaemon ] && . /mnt/stateful_partition/etc/.flintdaemon

  cd /usr/share/flint_daemon
  exec env DEBUG=$DEBUG node server.js 2>&1 | logger --priority daemon.info -t ${UPSTART_JOB}
end script
